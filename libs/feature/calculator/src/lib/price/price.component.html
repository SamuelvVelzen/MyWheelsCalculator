<div class="bg-primary text-light p-3 sm:p-5 sticky bottom-0">
  <div class="grid grid-cols-2">
    <div>
      <p class="text-sm">
        {{ 'calculator.price.total_price' | translate }}
      </p>
      <h2 class="text-2xl font-bold">
        {{ priceDetails().totalPrice | mwcCurrency }}
      </h2>
    </div>
    <div class="justify-self-end self-center flex gap-2">
      <mwc-button
        [themeType]="'Hover'"
        buttonClasses="hover:border-light border"
        (click)="showDetails()"
      >
        {{ 'calculator.price.show_details' | translate }}
      </mwc-button>

      <mwc-button [themeType]="'Hover'" [theme]="'Secondary'">
        <span class="hidden sm:block">{{
          'calculator.price.share' | translate
        }}</span>
        <span class="block sm:hidden">{{
          'calculator.price.share' | translate
        }}</span>
      </mwc-button>
    </div>
  </div>
</div>

<div class="bg-primary text-light" #priceDetailsSection>
  <div class="border-t-2 pt-3 border-light">
    <div class="px-3 pb-3 sm:px-5 sm:pb-5">
      <ng-container
        *ngTemplateOutlet="
          priceDetail;
          context: { details: priceDetailList(), depth: 0 }
        "
      ></ng-container>
    </div>
  </div>
</div>

<ng-template #priceDetail let-details="details" let-depth="depth">
  @for (detail of details; track $index) { @if(!detail.hide) {
  <div class="flex justify-between flex-wrap">
    <span>{{ detail.label | translate }}</span>
    <span>
      @if(detail.totalCost !== undefined || detail.totalCost !== null) {
      {{ detail.totalCost | mwcCurrency }}
      } @else {
      {{ detail.value }}
      }
    </span>

    @if(detail.children) {
    <div
      class="flex flex-col w-full"
      [ngStyle]="{ 'padding-left.px': depth + 1 * 10 }"
    >
      <ng-container
        *ngTemplateOutlet="
          priceDetail;
          context: { details: detail.children, depth: depth + 1 }
        "
      ></ng-container>
    </div>
    }
  </div>
  } }
</ng-template>
